# é«˜å°”å¤«è§†é¢‘ä¸‹è½½ API - å¿«é€Ÿéƒ¨ç½²

## ğŸš€ ä¸€é”®éƒ¨ç½²ï¼ˆæœ€ç®€å•ï¼‰

### Windows ç”¨æˆ·

1. **è·å– CloudFlare Token**
   - è®¿é—®ï¼šhttps://one.dash.cloudflare.com/
   - Networks â†’ Tunnels â†’ Create a tunnel
   - å¤åˆ¶æ˜¾ç¤ºçš„ Token

2. **é…ç½® Token**
   ```bash
   # åœ¨ MyVideoDownloder ç›®å½•åˆ›å»º .env æ–‡ä»¶
   # å†…å®¹å¦‚ä¸‹ï¼š
   TUNNEL_TOKEN=ä½ çš„token
   TZ=Asia/Shanghai
   ```

3. **å¯åŠ¨æœåŠ¡**
   - åŒå‡»è¿è¡Œï¼š`Windowså¯åŠ¨.bat`

4. **é…ç½®åŸŸå**
   - è¿”å› CloudFlare â†’ ä½ çš„ Tunnel â†’ Public Hostname
   - æ·»åŠ ï¼š
     - Service: `http://golf_video_api:80`
     - Domain: ä½ çš„åŸŸå

å®Œæˆï¼è®¿é—®ï¼š`https://ä½ çš„åŸŸå/docs`

## ğŸ“‹ è¯¦ç»†æ­¥éª¤

### æ­¥éª¤ 1: å‰ç½®å‡†å¤‡

ç¡®ä¿å·²å®‰è£…ï¼š
- âœ… Docker Desktopï¼ˆåœ¨ Windows ä¸­è¿è¡Œï¼‰
- âœ… WSL 2 + Ubuntu 22.04

### æ­¥éª¤ 2: åˆ›å»º CloudFlare Tunnel

1. ç™»å½• [CloudFlare Zero Trust](https://one.dash.cloudflare.com/)
2. å·¦ä¾§èœå•ï¼š**Networks** â†’ **Tunnels**
3. ç‚¹å‡» **Create a tunnel**
4. é€‰æ‹© **Cloudflared** ç±»å‹
5. è¾“å…¥åç§°ï¼š`golf-video-api`
6. ç‚¹å‡» **Save tunnel**
7. **å¤åˆ¶ Token**ï¼ˆå¾ˆé•¿çš„å­—ç¬¦ä¸²ï¼Œä»¥ `eyJ` å¼€å¤´ï¼‰

### æ­¥éª¤ 3: é…ç½®æ–‡ä»¶

åœ¨ `MyVideoDownloder` ç›®å½•åˆ›å»º `.env` æ–‡ä»¶ï¼š

```env
TUNNEL_TOKEN=eyJhIjoiMTIzNDU2Nzg5MGFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MTIzNDU2Nzg5MGFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6"
TZ=Asia/Shanghai
```

### æ­¥éª¤ 4: å¯åŠ¨æœåŠ¡

#### æ–¹å¼ A: Windows å¿«æ·æ–¹å¼ï¼ˆæ¨èï¼‰

åŒå‡» `Windowså¯åŠ¨.bat` æ–‡ä»¶

#### æ–¹å¼ B: WSL å‘½ä»¤è¡Œ

```bash
cd ~/projects/MyVideoDownloader/MyVideoDownloder
./éƒ¨ç½²åˆ°é«˜å°”å¤«.sh
```

### æ­¥éª¤ 5: é…ç½®å…¬ç½‘åŸŸå

1. è¿”å› CloudFlare Tunnel é¡µé¢
2. æ‰¾åˆ° **Public Hostname** éƒ¨åˆ†
3. ç‚¹å‡» **Add a public hostname**
4. å¡«å†™ï¼š
   - **Subdomain**: `golf-api`ï¼ˆæˆ–ä»»æ„åç§°ï¼‰
   - **Domain**: é€‰æ‹©ä½ çš„åŸŸå
   - **Service Type**: HTTP
   - **URL**: `golf_video_api:80`
5. ä¿å­˜

ä½ çš„ API å°†é€šè¿‡ `https://golf-api.ä½ çš„åŸŸå.com` è®¿é—®

## ğŸ”§ æ—¥å¸¸ç®¡ç†

### æŸ¥çœ‹çŠ¶æ€
åŒå‡»ï¼š`WindowsæŸ¥çœ‹çŠ¶æ€.bat`

### æŸ¥çœ‹æ—¥å¿—
åŒå‡»ï¼š`WindowsæŸ¥çœ‹æ—¥å¿—.bat`

### åœæ­¢æœåŠ¡
åŒå‡»ï¼š`Windowsåœæ­¢æœåŠ¡.bat`

### é‡å¯æœåŠ¡
```bash
wsl -d Ubuntu-22.04 bash -c "cd ~/projects/MyVideoDownloader/MyVideoDownloder && docker-compose -f docker-compose.golf.yml restart"
```

## ğŸ“± åœ¨é«˜å°”å¤« App ä¸­ä½¿ç”¨

### API åœ°å€
```
https://golf-api.ä½ çš„åŸŸå.com
```

### ç¤ºä¾‹ä»£ç ï¼ˆSwiftï¼‰

```swift
func downloadVideo(url: String) {
    let apiURL = "https://golf-api.ä½ çš„åŸŸå.com/api/hybrid/video_data"
    
    var request = URLRequest(url: URL(string: apiURL)!)
    request.httpMethod = "POST"
    request.setValue("application/json", forHTTPHeaderField: "Content-Type")
    
    let body = ["url": url]
    request.httpBody = try? JSONSerialization.data(withJSONObject: body)
    
    URLSession.shared.dataTask(with: request) { data, response, error in
        // å¤„ç†å“åº”
    }.resume()
}
```

### æ”¯æŒçš„è§†é¢‘å¹³å°
- âœ… æŠ–éŸ³
- âœ… TikTok
- âœ… Bç«™

## ğŸ› å¸¸è§é—®é¢˜

### é—®é¢˜ï¼šTunnel æ— æ³•è¿æ¥
**è§£å†³ï¼š** æ£€æŸ¥ Token æ˜¯å¦æ­£ç¡®
```bash
wsl -d Ubuntu-22.04 bash -c "cd ~/projects/MyVideoDownloader/MyVideoDownloder && cat .env"
```

### é—®é¢˜ï¼šæœ¬åœ°è®¿é—®æ­£å¸¸ä½†å…¬ç½‘æ— æ³•è®¿é—®
**è§£å†³ï¼š** æ£€æŸ¥ CloudFlare é…ç½®
- Service URL å¿…é¡»æ˜¯ `golf_video_api:80`
- ä¸æ˜¯ `localhost` æˆ– `127.0.0.1`

### é—®é¢˜ï¼šè§†é¢‘æ— æ³•ä¸‹è½½
**è§£å†³ï¼š** æŸ¥çœ‹æ—¥å¿—
```bash
wsl -d Ubuntu-22.04 bash -c "cd ~/projects/MyVideoDownloader/MyVideoDownloder && docker logs golf_video_api --tail 50"
```

## âœ… æµ‹è¯•

### æµ‹è¯•æœ¬åœ°
è®¿é—®ï¼šhttp://localhost:8081/docs

### æµ‹è¯•å…¬ç½‘
è®¿é—®ï¼šhttps://golf-api.ä½ çš„åŸŸå.com/docs

### æµ‹è¯• API
```bash
curl -X POST "https://golf-api.ä½ çš„åŸŸå.com/api/hybrid/video_data" \
  -H "Content-Type: application/json" \
  -d '{"url": "https://v.douyin.com/iJsyErwJ/"}'
```

## ğŸ¯ å®Œæˆï¼

ç°åœ¨ä½ çš„è§†é¢‘ä¸‹è½½æœåŠ¡ï¼š
- âœ… åœ¨ WSL Ubuntu ä¸­è¿è¡Œ
- âœ… Docker Desktop æŒç»­åŒ–
- âœ… CloudFlare å…¬ç½‘å¯è®¿é—®
- âœ… Windows å¼€æœºè‡ªåŠ¨å¯åŠ¨

äº«å—ä½¿ç”¨å§ï¼ ğŸ‰

